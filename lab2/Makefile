CC=g++
CFLAGS=-O3 -c -Wall -std=c++14
COMPFLAGS=-O3 -c -Wall -fopenmp -std=c++14

HEADER=linears.h

SERIES_MAIN_FILE=main
SERIES_IMPLEMENTATION_FILE=series
SERIES_EXE=series

PARAL_MAIN_FILE=main_omp
PARAL_IMPLEMENTATION_FILE=parallel
PARAL_EXE=parallel

SLE_GEN_SOURCE=gen_sle
SLE_GEN_EXE=gen-sle

CHECK_FILE=check

all: $(SERIES_EXE) $(PARAL_EXE) $(SLE_GEN_EXE) $(CHECK_FILE)


$(SERIES_EXE): $(SERIES_MAIN_FILE).o $(SERIES_IMPLEMENTATION_FILE).o
	$(CC) $(SERIES_MAIN_FILE).o $(SERIES_IMPLEMENTATION_FILE).o -o $(SERIES_EXE)

$(SERIES_MAIN_FILE).o: $(SERIES_MAIN_FILE).cpp $(HEADER)
	$(CC) $(CFLAGS) $(SERIES_MAIN_FILE).cpp -o $(SERIES_MAIN_FILE).o

$(SERIES_IMPLEMENTATION_FILE).o: $(SERIES_IMPLEMENTATION_FILE).cpp $(HEADER)
	$(CC) $(CFLAGS) $(SERIES_IMPLEMENTATION_FILE).cpp -o $(SERIES_IMPLEMENTATION_FILE).o


$(PARAL_EXE): $(PARAL_MAIN_FILE).o $(PARAL_IMPLEMENTATION_FILE).o
	$(CC) -fopenmp $(PARAL_MAIN_FILE).o $(PARAL_IMPLEMENTATION_FILE).o -o $(PARAL_EXE)

$(PARAL_MAIN_FILE).o: $(PARAL_MAIN_FILE).cpp $(HEADER)
	$(CC) $(COMPFLAGS) $(PARAL_MAIN_FILE).cpp -o $(PARAL_MAIN_FILE).o

$(PARAL_IMPLEMENTATION_FILE).o: $(PARAL_IMPLEMENTATION_FILE).cpp $(HEADER)
	$(CC) $(COMPFLAGS) $(PARAL_IMPLEMENTATION_FILE).cpp -o $(PARAL_IMPLEMENTATION_FILE).o



$(SLE_GEN_EXE): $(SLE_GEN_SOURCE).o
	$(CC) $(SLE_GEN_SOURCE).o -o $(SLE_GEN_EXE)

$(SLE_GEN_SOURCE).o: $(SLE_GEN_SOURCE).cpp
	$(CC) $(CFLAGS) $(SLE_GEN_SOURCE).cpp -o $(SLE_GEN_SOURCE).o

$(CHECK_FILE): $(CHECK_FILE).o $(SERIES_IMPLEMENTATION_FILE).o
	$(CC) $(CHECK_FILE).o $(SERIES_IMPLEMENTATION_FILE).o -o $(CHECK_FILE)

$(CHECK_FILE).o: $(CHECK_FILE).cpp $(HEADER)
	$(CC) $(CFLAGS) $(CHECK_FILE).cpp -o $(CHECK_FILE).o

clean:
	rm -rf *.o
